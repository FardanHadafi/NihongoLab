import{c as K,a as c,f as S}from"../chunks/CsDiZ3u4.js";import{o as te}from"../chunks/CdbuT949.js";import{p as ae,a9 as h,a7 as se,f as N,a as re,q as e,a5 as r,a8 as D,s as l,c as s,r as a,t as P,ag as ie}from"../chunks/IptEdv31.js";import{d as le,s as k}from"../chunks/5ZTY1J-d.js";import{i as $}from"../chunks/B_32Z2vQ.js";import{e as ne,i as oe}from"../chunks/BHhkrI38.js";import{s as ve}from"../chunks/OSNHeBV3.js";import{p as ce}from"../chunks/oPMBdB_o.js";import{g as de}from"../chunks/DwxrQ85W.js";var pe=S('<p class="loading">Loading Kanji lesson...</p>'),ue=S('<div class="result-card svelte-6x4m4k"><div class="result-header svelte-6x4m4k"><h2 class="result-title svelte-6x4m4k">Lesson Complete!</h2></div> <div class="stats-grid svelte-6x4m4k"><div class="stat-item svelte-6x4m4k"><span class="stat-label svelte-6x4m4k">Accuracy</span> <span class="stat-value svelte-6x4m4k"> </span></div> <div class="stat-item svelte-6x4m4k"><span class="stat-label svelte-6x4m4k">Experience</span> <span class="stat-value xp svelte-6x4m4k"> </span></div></div> <div class="result-actions svelte-6x4m4k"><button class="btn-primary svelte-6x4m4k">Next Lesson</button> <button class="btn-secondary svelte-6x4m4k">Back to Dashboard</button></div></div>'),me=S("<button> </button>"),fe=S('<div class="quiz svelte-6x4m4k"><p class="quiz-progress svelte-6x4m4k"> </p> <p class="quiz-type svelte-6x4m4k"> </p> <div class="quiz-character svelte-6x4m4k"> </div> <div class="options-grid svelte-6x4m4k"></div></div>');function we(M,Q){ae(Q,!0);let g=h(se([])),b=h(0),n=h(null),T=h(!1),z=h(!0),d=h(null),E=D(()=>ce.params.level),o=D(()=>e(g)[e(b)]);async function J(){r(z,!0),r(T,!1),r(b,0),r(n,null),r(d,null);const t=await fetch(`/api/learn/kanji?level=${e(E)}&limit=10`);r(g,await t.json(),!0),r(z,!1)}te(J);async function U(t){e(n)||!e(o)||(r(n,t,!0),await fetch("/api/learn/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({questionId:e(o).id,answer:t})}),setTimeout(()=>{r(n,null),ie(b),e(b)>=e(g).length&&(r(T,!0),X())},700))}async function X(){const t=await fetch("/api/learn/complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({questionIds:e(g).map(i=>i.id)})});r(d,await t.json(),!0)}function F(t){const i=/[\u4e00-\u9faf]/;return t.options.some(C=>i.test(C))?"Which kanji matches this meaning?":i.test(t.character)?"What does this kanji mean?":"How do you read this kanji?"}var R=K(),G=N(R);{var V=t=>{var i=pe();c(t,i)},Y=t=>{var i=K(),W=N(i);{var C=p=>{var u=ue(),y=l(s(u),2),j=s(y),m=l(s(j),2),q=s(m);a(m),a(j);var f=l(j,2),L=l(s(f),2),w=s(L);a(L),a(f),a(y);var O=l(y,2),_=s(O);_.__click=J;var H=l(_,2);H.__click=()=>de("/dashboard"),a(O),a(u),P(()=>{k(q,`${e(d).correct??""} / ${e(d).total??""}`),k(w,`+${e(d).expEarned??""} XP`)}),c(p,u)},Z=p=>{var u=K(),y=N(u);{var j=m=>{var q=fe(),f=s(q),L=s(f);a(f);var w=l(f,2),O=s(w,!0);a(w);var _=l(w,2),H=s(_,!0);a(_);var A=l(_,2);ne(A,21,()=>e(o).options,oe,(I,v)=>{var x=me();let B;x.__click=()=>U(e(v));var ee=s(x,!0);a(x),P(()=>{B=ve(x,1,"option svelte-6x4m4k",null,B,{correct:e(n)&&e(v)===e(o).correct,wrong:e(n)&&e(v)===e(n)&&e(v)!==e(o).correct}),x.disabled=!!e(n),k(ee,e(v))}),c(I,x)}),a(A),a(q),P((I,v)=>{k(L,`${I??""} Â· Question ${e(b)+1} / ${e(g).length??""}`),k(O,v),k(H,e(o).character)},[()=>e(E).toUpperCase(),()=>F(e(o))]),c(m,q)};$(y,m=>{e(o)&&m(j)},!0)}c(p,u)};$(W,p=>{e(T)&&e(d)?p(C):p(Z,!1)},!0)}c(t,i)};$(G,t=>{e(z)?t(V):t(Y,!1)})}c(M,R),re()}le(["click"]);export{we as component};
