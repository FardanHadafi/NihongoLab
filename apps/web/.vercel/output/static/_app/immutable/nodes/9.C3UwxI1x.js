import{f as p,a as n,b as Xe,c as Be}from"../chunks/CsDiZ3u4.js";import{o as Qe}from"../chunks/CdbuT949.js";import{p as Ve,c as a,s as l,t as y,a as We,a5 as d,q as s,J as se,ar as aa,r as e,f as ze,a9 as Ee,a8 as sa,a6 as H}from"../chunks/IptEdv31.js";import{d as Ie,e as Ke,s as i}from"../chunks/5ZTY1J-d.js";import{i as b}from"../chunks/B_32Z2vQ.js";import{e as He,i as De}from"../chunks/BHhkrI38.js";import{s as Ne}from"../chunks/DyT_7vXL.js";import{g as we}from"../chunks/5B9hMlRm.js";import{i as la}from"../chunks/CtUV__sE.js";import{s as be}from"../chunks/gIS0dabI.js";import{s as ta}from"../chunks/OSNHeBV3.js";import{s as ra}from"../chunks/B-8BkSJt.js";import{R as va,g as Ue}from"../chunks/DwxrQ85W.js";function ia(D,U){throw new va(D,U.toString())}var ca=p('<div class="dropdown-menu svelte-rfuq4y"><a href="/learn/kanji/N5" class="dropdown-item svelte-rfuq4y">N5 Kanji</a> <a href="/learn/kanji/N4" class="dropdown-item svelte-rfuq4y">N4 Kanji</a></div>'),na=Xe('<path d="M18 6L6 18M6 6l12 12" class="svelte-rfuq4y"></path>'),oa=Xe('<path d="M3 12h18M3 6h18M3 18h18" class="svelte-rfuq4y"></path>'),ua=p('<img class="profile-image svelte-rfuq4y"/>'),da=p('<div class="profile-avatar svelte-rfuq4y"> </div>'),pa=p('<img class="dropdown-image svelte-rfuq4y"/>'),fa=p('<div class="dropdown-avatar svelte-rfuq4y"> </div>'),_a=p('<div class="profile-dropdown svelte-rfuq4y"><div class="profile-header svelte-rfuq4y"><!> <div class="profile-info svelte-rfuq4y"><p class="profile-name svelte-rfuq4y"> </p> <p class="profile-email svelte-rfuq4y"> </p></div></div> <div class="dropdown-divider svelte-rfuq4y"></div> <a href="/profile" class="dropdown-item svelte-rfuq4y"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-rfuq4y"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" class="svelte-rfuq4y"></path><circle cx="12" cy="7" r="4" class="svelte-rfuq4y"></circle></svg> <span class="svelte-rfuq4y">Profile</span></a> <a href="/change-password" class="dropdown-item svelte-rfuq4y"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-rfuq4y"><rect x="3" y="11" width="18" height="11" rx="2" ry="2" class="svelte-rfuq4y"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4" class="svelte-rfuq4y"></path></svg> <span class="svelte-rfuq4y">Change Password</span></a> <div class="dropdown-divider svelte-rfuq4y"></div> <button class="dropdown-item logout svelte-rfuq4y"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-rfuq4y"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" class="svelte-rfuq4y"></path><polyline points="16 17 21 12 16 7" class="svelte-rfuq4y"></polyline><line x1="21" y1="12" x2="9" y2="12" class="svelte-rfuq4y"></line></svg> <span class="svelte-rfuq4y"> </span></button></div>'),ha=p('<div class="mobile-menu svelte-rfuq4y"><a href="/learn/hiragana" class="mobile-link svelte-rfuq4y"><span class="nav-icon svelte-rfuq4y">ã‚</span> <span class="svelte-rfuq4y">Hiragana</span></a> <a href="/learn/katakana" class="mobile-link svelte-rfuq4y"><span class="nav-icon svelte-rfuq4y">ã‚¢</span> <span class="svelte-rfuq4y">Katakana</span></a> <a href="/learn/kanji" class="mobile-link svelte-rfuq4y"><span class="nav-icon svelte-rfuq4y">æ¼¢</span> <span class="svelte-rfuq4y">Kanji</span></a></div>'),ma=p('<nav class="navbar svelte-rfuq4y"><div class="navbar-container svelte-rfuq4y"><a href="/dashboard" class="logo svelte-rfuq4y"><span class="logo-jp svelte-rfuq4y">æ—¥æœ¬èª</span> <span class="logo-name svelte-rfuq4y">NihongoLab</span></a> <div class="nav-links svelte-rfuq4y"><a href="/learn/hiragana" class="nav-link svelte-rfuq4y"><span class="nav-icon svelte-rfuq4y">ã‚</span> <span class="svelte-rfuq4y">Hiragana</span></a> <a href="/learn/katakana" class="nav-link svelte-rfuq4y"><span class="nav-icon svelte-rfuq4y">ã‚¢</span> <span class="svelte-rfuq4y">Katakana</span></a> <div class="nav-link kanji-dropdown svelte-rfuq4y"><button class="kanji-trigger svelte-rfuq4y"><span class="nav-icon svelte-rfuq4y">æ¼¢</span> <span class="svelte-rfuq4y">Kanji</span> <span class="caret svelte-rfuq4y">â–¾</span></button> <!></div></div> <button class="mobile-menu-button svelte-rfuq4y" aria-label="Menu"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-rfuq4y"><!></svg></button> <div class="profile-section svelte-rfuq4y"><button class="profile-button svelte-rfuq4y" aria-label="User menu"><!> <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M4 6l4 4 4-4" stroke="currentColor" stroke-width="2" fill="none" class="svelte-rfuq4y"></path></svg></button> <!></div></div> <!></nav>');function ga(D,U){Ve(U,!1);let v=se({name:"Loading...",email:"",image:null}),w=se(!1),q=se(!1),T=se(!1);Qe(async()=>{await le(),requestAnimationFrame(()=>{we.from(".navbar",{y:-100,opacity:0,clearProps:"transform"})})});async function le(){try{const t=await fetch("/api/users/me",{credentials:"include"});if(t.ok){const r=await t.json();d(v,{name:r.name||"User",email:r.email||"",image:r.image})}}catch(t){console.error("Failed to fetch user profile:",t)}}function te(){d(w,!s(w))}function re(){d(q,!s(q))}function k(){d(w,!1),d(q,!1)}let j=se(!1),m=null;function xe(){d(j,!s(j)),m&&(clearTimeout(m),m=null)}function o(){s(j)&&(m=setTimeout(()=>{d(j,!1)},500))}function N(){m&&(clearTimeout(m),m=null)}function ve(){d(j,!1),m&&(clearTimeout(m),m=null)}async function ke(){if(!s(T))try{d(T,!0),await ra({fetchOptions:{onSuccess:()=>{Ue("/sign-in")},onError:t=>{console.error("Logout error:",t.error),Ue("/sign-in")}}})}catch(t){console.error("Logout failed:",t),ia(302,"sign-in")}finally{d(T,!1)}}function ie(t){return t.split(" ").map(r=>r[0]).join("").toUpperCase().slice(0,2)}function C(t){const r=t.target;!r.closest(".profile-dropdown")&&!r.closest(".profile-button")&&d(w,!1),!r.closest(".mobile-menu")&&!r.closest(".mobile-menu-button")&&d(q,!1)}la();var x=ma();Ke("click",aa,C);var M=a(x),A=a(M);A.__click=k;var L=l(A,2),E=l(a(L),4),R=a(E);R.__click=xe;var ce=l(R,2);{var Me=t=>{var r=ca(),f=a(r);f.__click=ve;var g=l(f,2);g.__click=ve,e(r),n(t,r)};b(ce,t=>{s(j)&&t(Me)})}e(E),e(L);var P=l(L,2);P.__click=re;var X=a(P),Q=a(X);{var V=t=>{var r=na();n(t,r)},ne=t=>{var r=oa();n(t,r)};b(Q,t=>{s(q)?t(V):t(ne,!1)})}e(X),e(P);var oe=l(P,2),F=a(oe);F.__click=te;var ue=a(F);{var de=t=>{var r=ua();y(()=>{be(r,"src",s(v).image),be(r,"alt",s(v).name)}),n(t,r)},W=t=>{var r=da(),f=a(r,!0);e(r),y(g=>i(f,g),[()=>ie(s(v).name)]),n(t,r)};b(ue,t=>{s(v).image?t(de):t(W,!1)})}var I=l(ue,2);let pe;e(F);var fe=l(F,2);{var Le=t=>{var r=_a(),f=a(r),g=a(f);{var J=$=>{var z=pa();y(()=>{be(z,"src",s(v).image),be(z,"alt",s(v).name)}),n($,z)},G=$=>{var z=fa(),ye=a(z,!0);e(z),y(ae=>i(ye,ae),[()=>ie(s(v).name)]),n($,z)};b(g,$=>{s(v).image?$(J):$(G,!1)})}var Y=l(g,2),O=a(Y),Ce=a(O,!0);e(O);var S=l(O,2),he=a(S,!0);e(S),e(Y),e(f);var Z=l(f,4);Z.__click=k;var me=l(Z,2);me.__click=k;var K=l(me,4);K.__click=ke;var ee=l(a(K),2),ge=a(ee,!0);e(ee),e(K),e(r),y(()=>{i(Ce,s(v).name),i(he,s(v).email),K.disabled=s(T),i(ge,s(T)?"Signing Out...":"Sign Out")}),n(t,r)};b(fe,t=>{s(w)&&t(Le)})}e(oe),e(M);var _e=l(M,2);{var je=t=>{var r=ha(),f=a(r);f.__click=k;var g=l(f,2);g.__click=k;var J=l(g,2);J.__click=k,e(r),n(t,r)};b(_e,t=>{s(q)&&t(je)})}e(x),y(()=>pe=ta(I,0,"chevron svelte-rfuq4y",null,pe,{rotated:s(w)})),Ke("mouseleave",E,o),Ke("mouseenter",E,N),n(D,x),We()}Ie(["click"]);var ya=p('<div class="loading-state svelte-c1luzl"><div class="spinner svelte-c1luzl"></div> <p class="svelte-c1luzl">Loading...</p></div>'),qa=p('<div class="error-state svelte-c1luzl"><div class="error-icon svelte-c1luzl">âš ï¸</div> <h2 class="svelte-c1luzl">An error has occurred</h2> <p class="svelte-c1luzl"> </p> <button class="retry-btn svelte-c1luzl">Retry</button></div>'),za=p('<div class="next-level svelte-c1luzl"><span class="next-label svelte-c1luzl">Next Level</span> <span class="next-name svelte-c1luzl"> </span></div>'),ba=p('<div class="level-item stat-card svelte-c1luzl"><div class="level-item-header svelte-c1luzl"><h3 class="level-item-name svelte-c1luzl"> </h3> <span class="level-item-stats svelte-c1luzl"> </span></div> <div class="level-bar svelte-c1luzl"><div class="level-bar-fill svelte-c1luzl"></div></div> <p class="level-percentage svelte-c1luzl"> </p></div>'),wa=p('<div class="activity-day svelte-c1luzl"><div class="activity-bar svelte-c1luzl"></div> <span class="activity-count svelte-c1luzl"> </span></div>'),xa=p('<a href="/review" class="action-btn stat-card review-btn svelte-c1luzl"><span class="action-icon svelte-c1luzl">ğŸ”„</span> <span class="action-text svelte-c1luzl"> </span></a>'),ka=p('<div class="dashboard-header svelte-c1luzl"><h1 class="svelte-c1luzl">Dashboard</h1> <p class="welcome svelte-c1luzl"> </p></div> <section class="level-section svelte-c1luzl"><div class="level-card stat-card svelte-c1luzl"><div class="level-header svelte-c1luzl"><div class="current-level svelte-c1luzl"><span class="level-label svelte-c1luzl">Current Level</span> <span class="level-name svelte-c1luzl"> </span></div> <!></div> <div class="exp-progress svelte-c1luzl"><div class="exp-info svelte-c1luzl"><span class="exp-current svelte-c1luzl"> </span> <span class="exp-required svelte-c1luzl"> </span></div> <div class="progress-bar svelte-c1luzl"><div class="progress-fill svelte-c1luzl" style="width: 0%"></div></div> <p class="exp-remaining svelte-c1luzl"> </p></div></div></section> <section class="stats-grid svelte-c1luzl"><div class="stat-card streak-card svelte-c1luzl"><div class="stat-icon svelte-c1luzl">ğŸ”¥</div> <div class="stat-content svelte-c1luzl"><h3 class="stat-value svelte-c1luzl"> </h3> <p class="stat-label svelte-c1luzl">Consecutive Learning Streak</p></div></div> <div class="stat-card accuracy-card svelte-c1luzl"><div class="stat-icon svelte-c1luzl">ğŸ¯</div> <div class="stat-content svelte-c1luzl"><h3 class="stat-value svelte-c1luzl"> </h3> <p class="stat-label svelte-c1luzl">Correct Answer Rate</p></div></div> <div class="stat-card total-card svelte-c1luzl"><div class="stat-icon svelte-c1luzl">ğŸ“</div> <div class="stat-content svelte-c1luzl"><h3 class="stat-value svelte-c1luzl"> </h3> <p class="stat-label svelte-c1luzl">Total Answered</p></div></div> <div class="stat-card mastered-card svelte-c1luzl"><div class="stat-icon svelte-c1luzl">âœ…</div> <div class="stat-content svelte-c1luzl"><h3 class="stat-value svelte-c1luzl"> </h3> <p class="stat-label svelte-c1luzl">Total Mastered</p></div></div></section> <section class="level-breakdown svelte-c1luzl"><h2 class="svelte-c1luzl">Progress By Level</h2> <div class="level-list svelte-c1luzl"></div></section> <section class="activity-section svelte-c1luzl"><h2 class="svelte-c1luzl">Recent Activities</h2> <div class="activity-card stat-card svelte-c1luzl"><div class="activity-grid svelte-c1luzl"></div> <p class="activity-footer svelte-c1luzl">Learning History (7 Days)</p></div></section> <section class="quick-actions svelte-c1luzl"><h2 class="svelte-c1luzl">Quick Action</h2> <div class="actions-grid svelte-c1luzl"><!> <a href="/vocabulary" class="action-btn stat-card svelte-c1luzl"><span class="action-icon svelte-c1luzl">ğŸ“–</span> <span class="action-text svelte-c1luzl">Word List</span></a></div></section>',1),Ma=p('<!> <div class="dashboard svelte-c1luzl"><!></div>',1);function Sa(D,U){Ve(U,!0);let v=Ee(null),w=Ee(!0),q=Ee(""),T=sa(()=>{var o;return(o=s(v))!=null&&o.user.currentLevel?s(v).user.currentExp/s(v).user.currentLevel.requiredExp*100:0});Qe(async()=>{await le(),s(v)&&(requestAnimationFrame(()=>{we.fromTo(".stat-card",{opacity:0,y:30},{opacity:1,y:0,duration:.6,stagger:.1,ease:"power3.out",clearProps:"opacity,transform"})}),we.to(".progress-fill",{duration:1.2,width:`${s(T)}%`,ease:"power2.out",delay:.3}),we.from(".level-bar-fill",{duration:1,width:0,stagger:.15,ease:"power2.out",delay:.5}))});async function le(){try{d(w,!0),d(q,"");const o=await fetch("/api/dashboard",{credentials:"include"});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);d(v,await o.json(),!0)}catch(o){console.error("Failed to fetch dashboard data:",o),d(q,o instanceof Error?o.message:"Failed to load dashboard data",!0)}finally{d(w,!1)}}var te=Ma(),re=ze(te);ga(re,{});var k=l(re,2),j=a(k);{var m=o=>{var N=ya();n(o,N)},xe=o=>{var N=Be(),ve=ze(N);{var ke=C=>{var x=qa(),M=l(a(x),4),A=a(M,!0);e(M);var L=l(M,2);L.__click=le,e(x),y(()=>i(A,s(q))),n(C,x)},ie=C=>{var x=Be(),M=ze(x);{var A=L=>{var E=ka(),R=ze(E),ce=l(a(R),2),Me=a(ce);e(ce),e(R);var P=l(R,2),X=a(P),Q=a(X),V=a(Q),ne=l(a(V),2),oe=a(ne,!0);e(ne),e(V);var F=l(V,2);{var ue=_=>{var c=za(),u=l(a(c),2),h=a(u,!0);e(u),e(c),y(()=>i(h,s(v).user.nextLevel.name)),n(_,c)};b(F,_=>{s(v).user.nextLevel&&_(ue)})}e(Q);var de=l(Q,2),W=a(de),I=a(W),pe=a(I);e(I);var fe=l(I,2),Le=a(fe);e(fe),e(W);var _e=l(W,4),je=a(_e);e(_e),e(de),e(X),e(P);var t=l(P,2),r=a(t),f=l(a(r),2),g=a(f),J=a(g,!0);e(g),H(2),e(f),e(r);var G=l(r,2),Y=l(a(G),2),O=a(Y),Ce=a(O);e(O),H(2),e(Y),e(G);var S=l(G,2),he=l(a(S),2),Z=a(he),me=a(Z,!0);e(Z),H(2),e(he),e(S);var K=l(S,2),ee=l(a(K),2),ge=a(ee),$=a(ge,!0);e(ge),H(2),e(ee),e(K),e(t);var z=l(t,2),ye=l(a(z),2);He(ye,21,()=>s(v).levelProgress,De,(_,c)=>{var u=ba(),h=a(u),B=a(h),Pe=a(B,!0);e(B);var qe=l(B,2),$e=a(qe);e(qe),e(h);var Te=l(h,2),Ye=a(Te);e(Te);var Se=l(Te,2),Ze=a(Se);e(Se),e(u),y(ea=>{i(Pe,s(c).levelName),i($e,`${s(c).answeredCorrect??""} / ${s(c).totalQuestions??""}`),Ne(Ye,`width: ${s(c).percentage??""}%`),i(Ze,`${ea??""}% Completion`)},[()=>s(c).percentage.toFixed(1)]),n(_,u)}),e(ye),e(z);var ae=l(z,2),Ae=l(a(ae),2),Re=a(Ae);He(Re,21,()=>s(v).recentActivity.slice().reverse(),De,(_,c)=>{var u=wa(),h=a(u),B=l(h,2),Pe=a(B,!0);e(B),e(u),y((qe,$e)=>{Ne(u,`--intensity: ${qe??""}`),Ne(h,`height: ${$e??""}%`),i(Pe,s(c).count)},[()=>Math.min(s(c).count/30,1),()=>Math.min(s(c).count/30*100,100)]),n(_,u)}),e(Re),H(2),e(Ae),e(ae);var Fe=l(ae,2),Oe=l(a(Fe),2),Je=a(Oe);{var Ge=_=>{var c=xa(),u=l(a(c),2),h=a(u);e(u),e(c),y(()=>i(h,`Review (${s(v).questionsNeedingReview??""})`)),n(_,c)};b(Je,_=>{s(v).questionsNeedingReview>0&&_(Ge)})}H(2),e(Oe),e(Fe),y(_=>{var c,u,h;i(Me,`ã‚ˆã†ã“ãã€${s(v).user.name??""}ã•ã‚“ï¼`),i(oe,(c=s(v).user.currentLevel)==null?void 0:c.name),i(pe,`${s(v).user.currentExp??""} XP`),i(Le,`/ ${((u=s(v).user.currentLevel)==null?void 0:u.requiredExp)||1e3} XP`),i(je,`To the next level: ${(((h=s(v).user.currentLevel)==null?void 0:h.requiredExp)||1e3)-s(v).user.currentExp} XP`),i(J,s(v).stats.streak),i(Ce,`${_??""}%`),i(me,s(v).stats.totalAnswered),i($,s(v).questionsMastered)},[()=>s(v).stats.accuracyRate.toFixed(1)]),n(L,E)};b(M,L=>{s(v)&&L(A)},!0)}n(C,x)};b(ve,C=>{s(q)?C(ke):C(ie,!1)},!0)}n(o,N)};b(j,o=>{s(w)?o(m):o(xe,!1)})}e(k),n(D,te),We()}Ie(["click"]);export{Sa as component};
