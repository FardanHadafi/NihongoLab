import{f as _,a as v,b as m}from"../chunks/CsDiZ3u4.js";import{o as Ee}from"../chunks/CdbuT949.js";import{p as Ue,s as t,t as B,q as e,a as We,a5 as n,a9 as b,c as r,r as a,a6 as je,a8 as He}from"../chunks/IptEdv31.js";import{d as Re,e as Ve,s as T}from"../chunks/5ZTY1J-d.js";import{i as h}from"../chunks/B_32Z2vQ.js";import{s as I,r as J}from"../chunks/gIS0dabI.js";import{s as u}from"../chunks/OSNHeBV3.js";import{s as g}from"../chunks/DyT_7vXL.js";import{b as G}from"../chunks/Dfyq5I04.js";import{g as Ie}from"../chunks/5B9hMlRm.js";var Je=_('<div class="success-message svelte-bbdlun"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-bbdlun"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" class="svelte-bbdlun"></path><polyline points="22 4 12 14.01 9 11.01" class="svelte-bbdlun"></polyline></svg> <span class="svelte-bbdlun"> </span></div>'),Ge=_('<div class="error-message svelte-bbdlun"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-bbdlun"><circle cx="12" cy="12" r="10" class="svelte-bbdlun"></circle><line x1="12" y1="8" x2="12" y2="12" class="svelte-bbdlun"></line><line x1="12" y1="16" x2="12.01" y2="16" class="svelte-bbdlun"></line></svg> <span class="svelte-bbdlun"> </span></div>'),Ke=m('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-bbdlun"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24" class="svelte-bbdlun"></path><line x1="1" y1="1" x2="23" y2="23" class="svelte-bbdlun"></line></svg>'),Qe=m('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-bbdlun"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" class="svelte-bbdlun"></path><circle cx="12" cy="12" r="3" class="svelte-bbdlun"></circle></svg>'),Xe=m('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-bbdlun"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24" class="svelte-bbdlun"></path><line x1="1" y1="1" x2="23" y2="23" class="svelte-bbdlun"></line></svg>'),$e=m('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-bbdlun"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" class="svelte-bbdlun"></path><circle cx="12" cy="12" r="3" class="svelte-bbdlun"></circle></svg>'),es=_('<div class="password-strength svelte-bbdlun"><div class="strength-bars svelte-bbdlun"><div></div> <div></div> <div></div> <div></div> <div></div></div> <span class="strength-label svelte-bbdlun"> </span></div>'),ss=m('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-bbdlun"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24" class="svelte-bbdlun"></path><line x1="1" y1="1" x2="23" y2="23" class="svelte-bbdlun"></line></svg>'),ls=m('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-bbdlun"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" class="svelte-bbdlun"></path><circle cx="12" cy="12" r="3" class="svelte-bbdlun"></circle></svg>'),ts=_(`<p class="error-text svelte-bbdlun">Passowrd Doesn't Match</p>`),rs=_('<p class="success-text svelte-bbdlun">âœ“ Password Match</p>'),as=_(`<div class="password-page svelte-bbdlun"><div class="password-container svelte-bbdlun"><div class="password-header svelte-bbdlun"><a href="/profile" class="back-link svelte-bbdlun"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-bbdlun"><path d="M19 12H5M12 19l-7-7 7-7" class="svelte-bbdlun"></path></svg> <span class="svelte-bbdlun">Return To Profile</span></a> <h1 class="svelte-bbdlun">Change Password</h1> <p class="subtitle svelte-bbdlun">Increase Your Account Security</p></div> <div class="password-card svelte-bbdlun"><!> <!> <form class="svelte-bbdlun"><div class="form-group svelte-bbdlun"><label for="currentPassword" class="form-label svelte-bbdlun">Current Password *</label> <div class="password-input-wrapper svelte-bbdlun"><input id="currentPassword" class="form-input svelte-bbdlun" placeholder="Enter Current Password" required/> <button type="button" class="toggle-password svelte-bbdlun" aria-label="Toggle password visibility"><!></button></div></div> <div class="form-group svelte-bbdlun"><label for="newPassword" class="form-label svelte-bbdlun">New Password *</label> <div class="password-input-wrapper svelte-bbdlun"><input id="newPassword" class="form-input svelte-bbdlun" placeholder="New Password At Least 8 Characters" required/> <button type="button" class="toggle-password svelte-bbdlun" aria-label="Toggle password visibility"><!></button></div> <!> <ul class="password-requirements svelte-bbdlun"><li>8 Characters or More</li> <li>Contains Uppercase and Lowercase Letters</li> <li>Contains Numbers</li> <li>Contains Special Characters</li></ul></div> <div class="form-group svelte-bbdlun"><label for="confirmPassword" class="form-label svelte-bbdlun">New Password (Confirm) *</label> <div class="password-input-wrapper svelte-bbdlun"><input id="confirmPassword" class="form-input svelte-bbdlun" placeholder="Type it Again" required/> <button type="button" class="toggle-password svelte-bbdlun" aria-label="Toggle password visibility"><!></button></div> <!> <!></div> <div class="form-actions svelte-bbdlun"><a href="/profile" class="btn btn-secondary svelte-bbdlun">Cancel</a> <button type="submit" class="btn btn-primary svelte-bbdlun"> </button></div></form> <div class="security-tips svelte-bbdlun"><h3 class="svelte-bbdlun">Security Tips</h3> <ul class="svelte-bbdlun"><li class="svelte-bbdlun">Change Your Password Regularly</li> <li class="svelte-bbdlun">Don't Use Passwords You Use On Other Sites</li> <li class="svelte-bbdlun">Don't Share Your Password With Anyone</li></ul></div></div></div></div>`);function ws(ge,_e){Ue(_e,!0);let w=b(""),o=b(""),c=b(""),P=b(!1),p=b(""),y=b(""),x=b(!1),k=b(!1),C=b(!1),i=He(()=>e(o)?me(e(o)):{score:0,label:"",color:""});Ee(()=>{Ie.from(".password-card",{duration:.6,y:30,opacity:0,ease:"power3.out"})});function me(s){let l=0;return s.length>=8&&l++,s.length>=12&&l++,/[a-z]/.test(s)&&/[A-Z]/.test(s)&&l++,/\d/.test(s)&&l++,/[^a-zA-Z0-9]/.test(s)&&l++,l<=1?{score:l,label:"Weak",color:"#dc2626"}:l<=3?{score:l,label:"Moderate",color:"#f59e0b"}:{score:l,label:"Strong",color:"#10b981"}}async function ye(s){if(s.preventDefault(),n(p,""),n(y,""),!e(w)||!e(o)||!e(c)){n(p,"Please Fill in All Fields");return}if(e(o).length<8){n(p,"Password Must Be At Least 8 Characters");return}if(e(o)!==e(c)){n(p,'New Password Doesn"t Match');return}if(e(w)===e(o)){n(p,"The New Password Must Be Different From The Current Password");return}try{n(P,!0);const l=await fetch("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({currentPassword:e(w),newPassword:e(o)})});if(!l.ok){const d=await l.json();throw new Error(d.message||"Password Change Failed")}n(y,"Your Password Has Been Changed !"),n(w,""),n(o,""),n(c,""),setTimeout(()=>{n(y,"")},5e3)}catch(l){console.error("Password change failed:",l),n(p,l instanceof Error?l.message:"Password Change Failed",!0)}finally{n(P,!1)}}function N(s){s==="current"&&n(x,!e(x)),s==="new"&&n(k,!e(k)),s==="confirm"&&n(C,!e(C))}var z=as(),K=r(z),Q=t(r(K),2),X=r(Q);{var Pe=s=>{var l=Je(),d=t(r(l),2),f=r(d,!0);a(d),a(l),B(()=>T(f,e(y))),v(s,l)};h(X,s=>{e(y)&&s(Pe)})}var $=t(X,2);{var xe=s=>{var l=Ge(),d=t(r(l),2),f=r(d,!0);a(d),a(l),B(()=>T(f,e(p))),v(s,l)};h($,s=>{e(p)&&s(xe)})}var D=t($,2),q=r(D),ee=t(r(q),2),M=r(ee);J(M);var F=t(M,2);F.__click=()=>N("current");var ke=r(F);{var Ce=s=>{var l=Ke();v(s,l)},Me=s=>{var l=Qe();v(s,l)};h(ke,s=>{e(x)?s(Ce):s(Me,!1)})}a(F),a(ee),a(q);var Y=t(q,2),L=t(r(Y),2),A=r(L);J(A);var O=t(A,2);O.__click=()=>N("new");var Ae=r(O);{var Se=s=>{var l=Xe();v(s,l)},Be=s=>{var l=$e();v(s,l)};h(Ae,s=>{e(k)?s(Se):s(Be,!1)})}a(O),a(L);var se=t(L,2);{var Te=s=>{var l=es(),d=r(l),f=r(d);let be;var j=t(f,2);let ue;var H=t(j,2);let pe;var R=t(H,2);let he;var we=t(R,2);let fe;a(d);var V=t(d,2),Ze=r(V,!0);a(V),a(l),B(()=>{be=u(f,1,"strength-bar svelte-bbdlun",null,be,{active:e(i).score>=1}),g(f,`background-color: ${(e(i).score>=1?e(i).color:"#e5e7eb")??""}`),ue=u(j,1,"strength-bar svelte-bbdlun",null,ue,{active:e(i).score>=2}),g(j,`background-color: ${(e(i).score>=2?e(i).color:"#e5e7eb")??""}`),pe=u(H,1,"strength-bar svelte-bbdlun",null,pe,{active:e(i).score>=3}),g(H,`background-color: ${(e(i).score>=3?e(i).color:"#e5e7eb")??""}`),he=u(R,1,"strength-bar svelte-bbdlun",null,he,{active:e(i).score>=4}),g(R,`background-color: ${(e(i).score>=4?e(i).color:"#e5e7eb")??""}`),fe=u(we,1,"strength-bar svelte-bbdlun",null,fe,{active:e(i).score>=5}),g(we,`background-color: ${(e(i).score>=5?e(i).color:"#e5e7eb")??""}`),g(V,`color: ${e(i).color??""}`),T(Ze,e(i).label)}),v(s,l)};h(se,s=>{e(o)&&s(Te)})}var le=t(se,2),te=r(le);let re;var ae=t(te,2);let oe;var ne=t(ae,2);let ie;var Ne=t(ne,2);let de;a(le),a(Y);var Z=t(Y,2),E=t(r(Z),2),S=r(E);J(S);var U=t(S,2);U.__click=()=>N("confirm");var ze=r(U);{var De=s=>{var l=ss();v(s,l)},qe=s=>{var l=ls();v(s,l)};h(ze,s=>{e(C)?s(De):s(qe,!1)})}a(U),a(E);var ve=t(E,2);{var Fe=s=>{var l=ts();v(s,l)};h(ve,s=>{e(c)&&e(o)!==e(c)&&s(Fe)})}var Ye=t(ve,2);{var Le=s=>{var l=rs();v(s,l)};h(Ye,s=>{e(c)&&e(o)===e(c)&&s(Le)})}a(Z);var ce=t(Z,2),W=t(r(ce),2),Oe=r(W,!0);a(W),a(ce),a(D),je(2),a(Q),a(K),a(z),B((s,l,d)=>{I(M,"type",e(x)?"text":"password"),I(A,"type",e(k)?"text":"password"),re=u(te,1,"svelte-bbdlun",null,re,{met:e(o).length>=8}),oe=u(ae,1,"svelte-bbdlun",null,oe,s),ie=u(ne,1,"svelte-bbdlun",null,ie,l),de=u(Ne,1,"svelte-bbdlun",null,de,d),I(S,"type",e(C)?"text":"password"),W.disabled=e(P)||!e(w)||!e(o)||!e(c)||e(o)!==e(c),T(Oe,e(P)?"Changing...":"Change Password")},[()=>({met:/[a-z]/.test(e(o))&&/[A-Z]/.test(e(o))}),()=>({met:/\d/.test(e(o))}),()=>({met:/[^a-zA-Z0-9]/.test(e(o))})]),Ve("submit",D,ye),G(M,()=>e(w),s=>n(w,s)),G(A,()=>e(o),s=>n(o,s)),G(S,()=>e(c),s=>n(c,s)),v(ge,z),We()}Re(["click"]);export{ws as component};
