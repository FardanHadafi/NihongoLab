import{c as z,a,f as c,t as se}from"../chunks/CsDiZ3u4.js";import{p as re,f as A,a as oe,q as e,a8 as ie,a9 as I,c as o,s as f,r as s,t as q,a5 as n}from"../chunks/IptEdv31.js";import{d as ne,s as C}from"../chunks/5ZTY1J-d.js";import{i as N}from"../chunks/B_32Z2vQ.js";import{e as ve,i as le}from"../chunks/BHhkrI38.js";import{r as ce}from"../chunks/gIS0dabI.js";import{s as de}from"../chunks/OSNHeBV3.js";import{b as ge}from"../chunks/Dfyq5I04.js";import{g as ue}from"../chunks/DwxrQ85W.js";var _e=c('<p class="empty svelte-gwgoya">Nothing to review today!</p>'),pe=c(`<div class="review finished svelte-gwgoya"><div class="card svelte-gwgoya"><h2 class="question svelte-gwgoya">Review Complete!</h2> <p class="type svelte-gwgoya">You've finished all your review items.</p> <button class="next svelte-gwgoya">Back to Dashboard</button></div></div>`),fe=c('<button class="option svelte-gwgoya"> </button>'),me=c('<div class="options svelte-gwgoya"></div>'),we=c('<input class="input svelte-gwgoya" placeholder="Type your answer"/>'),ye=c('<!> <button class="submit svelte-gwgoya">Check</button>',1),be=c('❌ Incorrect <span class="answer svelte-gwgoya"> </span>',1),he=c('<div><!></div> <button class="next svelte-gwgoya"> </button>',1),xe=c('<section class="review svelte-gwgoya"><div class="progress svelte-gwgoya"> </div> <div class="card svelte-gwgoya"><p class="type svelte-gwgoya"> </p> <h2 class="question svelte-gwgoya"> </h2> <!></div></section>');function Ee(G,P){re(P,!0);let m=I(0),w=I(""),y=I(!1),E=I(!1),b=I(null);const T=ie(()=>P.data.questions),h=()=>e(T)[e(m)];async function R(){if(!e(w).trim()||e(E))return;n(y,!0);const v=await fetch("/api/dashboard/review/answer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({questionId:h().questionId,userAnswer:e(w)})});if(!v.ok)throw n(y,!1),new Error("Failed to submit answer");n(b,await v.json(),!0),n(y,!1)}function H(){n(b,null),n(w,""),e(m)+1>=e(T).length?n(E,!0):n(m,e(m)+1)}var U=z(),K=A(U);{var L=v=>{var S=_e();a(v,S)},M=v=>{var S=z(),V=A(S);{var W=x=>{var u=pe(),k=o(u),F=f(o(k),4);F.__click=()=>ue("/dashboard"),s(k),s(u),a(x,u)},X=x=>{var u=xe(),k=o(u),F=o(k);s(k);var Y=f(k,2),O=o(Y),Z=o(O);s(O);var Q=f(O,2),$=o(Q,!0);s(Q);var ee=f(Q,2);{var te=d=>{var _=ye(),l=A(_);{var B=i=>{var r=me();ve(r,21,()=>h().options,le,(t,p)=>{var g=fe();g.__click=()=>n(w,e(p),!0);var J=o(g,!0);s(g),q(()=>{g.disabled=e(y),C(J,e(p))}),a(t,g)}),s(r),a(i,r)},D=i=>{var r=we();ce(r),r.__keydown=t=>t.key==="Enter"&&R(),q(()=>r.disabled=e(y)),ge(r,()=>e(w),t=>n(w,t)),a(i,r)};N(l,i=>{h().questionType==="meaning"?i(B):i(D,!1)})}var j=f(l,2);j.__click=R,q(()=>j.disabled=e(y)),a(d,_)},ae=d=>{var _=he(),l=A(_),B=o(l);{var D=t=>{var p=se("✅ Correct!");a(t,p)},j=t=>{var p=be(),g=f(A(p)),J=o(g);s(g),q(()=>C(J,`Correct: ${e(b).correctAnswer??""}`)),a(t,p)};N(B,t=>{e(b).isCorrect?t(D):t(j,!1)})}s(l);var i=f(l,2);i.__click=H;var r=o(i,!0);s(i),q(()=>{de(l,1,`feedback ${e(b).isCorrect?"correct":"wrong"}`,"svelte-gwgoya"),C(r,e(m)+1>=e(T).length?"Finish":"Next")}),a(d,_)};N(ee,d=>{e(b)?d(ae,!1):d(te)})}s(Y),s(u),q((d,_,l)=>{C(F,`${e(m)+1} / ${e(T).length??""}`),C(Z,`${d??""} · ${_??""}`),C($,l)},[()=>h().scriptType.toUpperCase(),()=>h().questionType,()=>h().questionText]),a(x,u)};N(V,x=>{e(E)?x(W):x(X,!1)},!0)}a(v,S)};N(K,v=>{e(T).length===0?v(L):v(M,!1)})}a(G,U),oe()}ne(["click","keydown"]);export{Ee as component};
