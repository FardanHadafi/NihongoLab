import{f as _,a as h}from"../chunks/CsDiZ3u4.js";import{ai as Ce,L as Le,aj as Se,ak as ke,p as Ee,a9 as k,a7 as Ie,a1 as Me,a5 as m,c as l,s as c,t as C,a as je,q as a,r as s,a8 as Ne,f as Ue}from"../chunks/IptEdv31.js";import{d as De,s as f}from"../chunks/5ZTY1J-d.js";import{i as E}from"../chunks/B_32Z2vQ.js";import{e as Q,i as V}from"../chunks/BHhkrI38.js";import{r as Fe,a as Re}from"../chunks/gIS0dabI.js";import{g as Te}from"../chunks/DwxrQ85W.js";function $(i,o,d=!1){if(i.multiple){if(o==null)return;if(!Le(o))return Se();for(var v of i.options)v.selected=o.includes(G(v));return}for(v of i.options){var u=G(v);if(ke(u,o)){v.selected=!0;return}}(!d||o!==void 0)&&(i.selectedIndex=-1)}function qe(i){var o=new MutationObserver(()=>{$(i,i.__value)});o.observe(i,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ce(()=>{o.disconnect()})}function G(i){return"__value"in i?i.__value:i.value}var Ae=_('<button class="clear-btn svelte-1ch1amb" aria-label="Clear search">✕</button>'),Je=_('<option class="svelte-1ch1amb"> </option>'),Oe=_('<span class="stat-badge more-available svelte-1ch1amb">More available ↓</span>'),Pe=_('<div class="empty-state svelte-1ch1amb"><p class="svelte-1ch1amb">No vocabulary found</p> <p class="empty-hint svelte-1ch1amb">Try adjusting your search or level filter</p></div>'),Ke=_('<div class="vocab-reading svelte-1ch1amb"> </div>'),Qe=_('<div class="vocab-card svelte-1ch1amb"><div class="vocab-japanese svelte-1ch1amb"> </div> <!> <div class="vocab-english svelte-1ch1amb"> </div> <div class="vocab-pos svelte-1ch1amb"> </div></div>'),Ve=_('<section class="category-section svelte-1ch1amb"><h2 class="category-title svelte-1ch1amb"> <span class="category-count svelte-1ch1amb"> </span></h2> <div class="vocab-grid svelte-1ch1amb"></div></section>'),ze=_('<div class="load-more-container svelte-1ch1amb"><button class="load-more-btn svelte-1ch1amb">Load More</button></div>'),Be=_('<div class="categories svelte-1ch1amb"></div> <!>',1),He=_('<div class="container svelte-1ch1amb"><header class="header svelte-1ch1amb"><h1 class="svelte-1ch1amb">Japanese Vocabulary</h1> <p class="subtitle svelte-1ch1amb">Learn and explore Japanese words by category</p></header> <div class="controls svelte-1ch1amb"><div class="search-bar svelte-1ch1amb"><input type="text" placeholder="Search vocabulary..." class="search-input svelte-1ch1amb"/> <!></div> <div class="level-selector svelte-1ch1amb"><label for="level" class="svelte-1ch1amb">Level:</label> <select id="level" class="svelte-1ch1amb"></select></div></div> <div class="stats svelte-1ch1amb"><span class="stat-badge svelte-1ch1amb"> </span> <span class="stat-badge svelte-1ch1amb"> </span> <!></div> <!></div>');function aa(i,o){Ee(o,!0);let d=k(""),v=k(1),u=k(Ie([])),p=k(null),I=k(!1);Me(()=>{m(u,o.data.categories||[],!0),m(p,o.data.nextCursor??null,!0),m(v,o.data.levelId,!0),m(d,o.data.search??"",!0)});function ee(e,r){const n=new Map;return e.forEach(t=>{n.set(t.category,[...t.items])}),r.forEach(t=>{const b=n.get(t.category)||[];n.set(t.category,[...b,...t.items])}),Array.from(n.entries()).map(([t,b])=>({category:t,items:b}))}let ae=Ne(()=>a(u)?a(u).reduce((e,r)=>e+r.items.length,0):0);async function te(){var e;if(!(a(p)===null||a(I))){m(I,!0);try{const r=new URLSearchParams({levelId:a(v).toString(),limit:"25",cursor:a(p).toString()});a(d)&&r.set("search",a(d));const n=await fetch(`/api/vocabulary?${r.toString()}`);if(!n.ok)throw new Error("Failed to load more vocabulary");const t=await n.json();console.log("Loaded more data:",{prevCursor:a(p),newCursor:t.nextCursor,newItems:((e=t.categories)==null?void 0:e.reduce((b,y)=>b+y.items.length,0))??0}),m(u,ee(a(u),t.categories||[]),!0),m(p,t.nextCursor,!0)}catch(r){console.error("Error loading more vocabulary:",r)}finally{m(I,!1)}}}function re(e){m(d,e,!0)}function se(e){e.key==="Enter"&&M()}function le(e){m(v,e,!0),M()}function M(){const e=new URLSearchParams;a(v)!==1&&e.set("level",a(v).toString()),a(d)&&e.set("q",a(d)),Te(`?${e.toString()}`,{keepFocus:!0,noScroll:!0})}function ie(){m(d,""),M()}function oe(e){return e.charAt(0).toUpperCase()+e.slice(1)}var j=He(),N=c(l(j),2),U=l(N),L=l(U);Fe(L),L.__input=e=>re(e.currentTarget.value),L.__keydown=se;var ve=c(L,2);{var ce=e=>{var r=Ae();r.__click=ie,h(e,r)};E(ve,e=>{a(d)&&e(ce)})}s(U);var z=c(U,2),g=c(l(z),2);g.__change=e=>le(Number(e.currentTarget.value)),Q(g,20,()=>[5,4,3,2,1],V,(e,r,n)=>{var t=Je(),b=l(t);s(t),t.value=t.__value=n+1,C(()=>f(b,`N${r??""}`)),h(e,t)}),s(g);var B;qe(g),s(z),s(N);var D=c(N,2),F=l(D),ne=l(F);s(F);var R=c(F,2),de=l(R);s(R);var ue=c(R,2);{var me=e=>{var r=Oe();h(e,r)};E(ue,e=>{a(p)&&e(me)})}s(D);var he=c(D,2);{var _e=e=>{var r=Pe();h(e,r)},be=e=>{var r=Be(),n=Ue(r);Q(n,21,()=>a(u),V,(y,x)=>{var w=Ve(),T=l(w),H=l(T),W=c(H),fe=l(W,!0);s(W),s(T);var X=c(T,2);Q(X,21,()=>a(x).items,V,(q,S)=>{var A=Qe(),J=l(A),pe=l(J,!0);s(J);var Y=c(J,2);{var ge=P=>{var K=Ke(),we=l(K,!0);s(K),C(()=>f(we,a(S).reading)),h(P,K)};E(Y,P=>{a(S).reading&&P(ge)})}var O=c(Y,2),ye=l(O,!0);s(O);var Z=c(O,2),xe=l(Z,!0);s(Z),s(A),C(()=>{f(pe,a(S).word),f(ye,a(S).meaning),f(xe,a(S).partOfSpeech)}),h(q,A)}),s(X),s(w),C(q=>{f(H,`${q??""} `),f(fe,a(x).items.length)},[()=>oe(a(x).category)]),h(y,w)}),s(n);var t=c(n,2);{var b=y=>{var x=ze(),w=l(x);w.__click=te,s(x),C(()=>w.disabled=a(I)||a(p)===null),h(y,x)};E(t,y=>{a(p)&&y(b)})}h(e,r)};E(he,e=>{!a(u)||a(u).length===0?e(_e):e(be,!1)})}s(j),C(()=>{var e;Re(L,a(d)),B!==(B=a(v))&&(g.value=(g.__value=a(v))??"",$(g,a(v))),f(ne,`${a(ae)??""} words loaded`),f(de,`${(((e=a(u))==null?void 0:e.length)||0)??""} categories`)}),h(i,j),je()}De(["input","keydown","click","change"]);export{aa as component};
